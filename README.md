Abstract

Sleep Apnea could be a common clutter of sleep caused by hindering wind stream due to break down of the delicate tissue encompassing the upper aviation route of mouth or throat, and typical breathing would begin once more with a uproarious grunt or choking sound. A conventional distinguishing proof handle of Rest Apnea is polysomnography, which can as it were be went with in rest middle with particular declarations, in this way it is expensive and risky. In expansion, it is utilized for understanding the conditions, without treatment work. Supplementary identifying methods are Electrocardiogram (ECG), Beat Oximeter, mouthpiece or taking a video. Many methodologies or contraptions have been made to help Rest Apnea, such as; Persistent Positive Aviation Route Weight (CPAP), APAP (Programmed Positive Aviation Route Weight), BiPAP (Bilevel Positive Aviation Route Weight), intraoral mandibular progression gadget and surgery. There are a few parameters which offer assistance lower the chance of Rest Apnea are; Surgery(uvulopalatoplasty), Intra-oral mandibular progression, utilize of anti-snore pads, weight control, resting in sideways position (Night Adjust) and positional Therapy.

Acknowledgments

We are humbly grateful to Almighty ALLAH, who has blessed us with power to learn and excel in our lives. We owe this all to our beloved parents, their prayers have been with us through the entire thick and thin of life. Their extreme love, moral support and persuasion has enabled us to achieve this goal. Secondly, we are highly indebted to our supervisor Maqsood Muhammad Khan, Associate Professor and Director of NUCES-Peshawar for his advice, assistance, direction, and invaluable contribution to this project. His intellectual ideas and perspective have been a great support.  We, also, extend our gratitude to him for providing the facilities and motivation to complete this project successfully. We are, indeed, grateful to him for offering his services up to their utmost.

CHAPTER 1
INTRODUCTION


This chapter introduces our project and it is divided into three parts Brief Introduction, Problem Statement and Thesis Organization. Now a day it is very important to share ideas, discus work experience and other important issues with each other.
	Brief Introduction:

All is possible by technology, improved safety, sustainable living. From the beginning of technology, Human beings strived towards building machines to provide ease and efficiency. Artificial Intelligence is removing almost every obstacle to provide efficiency and better results, and it is helping in medical sciences, engineering, and business and daily life. Sleep Apnea could be a communal disorder of sleep caused by discouraging wind current due to break down of the delicate tissue encompassing the upper aviation route of mouth or throat. Individual who has Sleep Apnea halt breathing more than once whereas rest, indeed in a few cases, it happens hundreds of times. This implies the brain and the rest of the body may not get sufficient oxygen. Within the world, the in general proportion of sleep Apnea is approximately 2% to 4% (almost 200 million Rest Apnea understanding all over the world) and approximately 80% of individuals don‚Äôt know that they have Sleep Apnea. Rest Apnea is categorized into three sorts. One that happens due to corpulence and overweight is known as Obstructive sort of Rest Apnea (OSA) and it is encourage isolated into two occasions; Nonstop and Intermittent. OSA happens when the upper aviation route is blocked totally or partly, the oxygen level is additionally diminished in body due to which the quiet heart will encounter sporadic rhythms. Moment shape of Rest Apnea incorporates Central Rest Apnea (CSA) in which the brain does not work appropriately and aviation route is blocked numerous times amid rest. The third sort of Rest Apnea is Blended Rest Apnea (MSA) which is essentially the combination of both over sorts. The indications of MSA for the most part emerges due to the treatment of CSA


                 Methodology of Project:

Our implementation and design of the project is to recognize different sleep disorders and sleep patterns through use of a low voltage protected sensor in the pillow with Machine learning for more accuracy. We are aiming for a better accurate and non-intrusive way of detecting different sleep disorder and bad sleep patterns. Our aim is the ease of use for both in hospital and commercial platform. Our project will be using both physical signal from the pillow sensors and biological signals from the smartwatch and by comparing both data and displaying it on the screen of users and sharing it can also be directly connected with your doctor, this project accuracy and functionality will be first of its kind.

Problem Statement:

Source of Problem Observation:

Sleep is an important component of everyone's overall health and well-being, and in most cases is neglected. Sleep is very important in order for your body to be ready to restore health and be ready for the next day. Sleep deprivation affects your overall health very commonly in most cases, and predisposes you to serious health conditions such as obesity, heart disease, high blood pressure, and diabetes. Some sleep can be fatal if left untreated, as side effects that cause serious problems for an individual's physical, mental and social health. However, most of the traditional methods of recording physiological changes during sleep are unnoticed, unobtrusive, challenging and difficult to avoid. Smart Pillow was developed to provide a relatively easy way to observe sleep conditions and sleep disorders through physical and vital signs.

Thesis Organization:

The structure of this thesis comprises of 5 chapters; Chapter 1 is a brief introduction; Chapter 2 is History and Related works and Chapter 3 is Components; Chapter 4 is Solution/Design/Implementation and finally Chapter 5 is about Results/Conclusions/ Recommendations



CHAPTER 2
HISTORY & RELATED WORK

In research on Smart Pillow by Vandana et al [1] has Integrating features of all the hardware components used have been developed in it. The Presence of every module has been reasoned out and placed carefully, thus contributing to the best working of the unit of the project. Secondly, using highly advanced IC with help of growing technology, the project has been successfully implemented. The ‚ÄúSmart Pillow‚Äù was successfully implemented with the resources available and the extent of our knowledge and further looking to integrate some more advanced features. 
In the article A Smart Pillow for Health Sensing System Based on Temperature and Humidity Sensors by Song sheng and Christopher [3] their paper presents a smart pillow based on 3 temperature sensors and a humidity sensor, which is the core element of the Health Sensing System. Specifically, a report is provided daily by analyzing time series data from the pillow, which reflects the sleep status of a user faithfully like a camera, but it offers extra information such as body temperature and sweat [2].
 Fedora and Lysenko et al research on Respiratory Events Screening Using Consumer Smartwatches [5] Here, they proposed the deep learning LSTM based model for sleep-related RE detection during nocturnal sleep based on data from consumer (Samsung) smartwatch sensors. High accuracy of epoch-by-epoch RE classification along with the sufficient correspondence with AHI values were achieved. To increase the model robustness and performance the sleep stages classifier was combined with the RE classification model.
 Aravalli and U et al proposed a paper of Design and Development of Wearable Device for Continuous Monitoring of Sleep APNEA Disorder [6]. In their proposed study, wearable continuous sleep apnea monitoring system was developed which can measure spo2, heart rate and blood pressure by cuff less means in real time. This monitoring device overcomes the complexities of the other commonly used portable sleep apnea device.


CHAPTER 3
COMPONENTS

	
Components Description:
The components used in this project are Raspberry pi 3b+, FSR Pressure sensor, DHT11 Humidity sensor and Microphones. 
	Raspberry pi 3b:

Raspberry Pi 3 Model B + is the latest product in the Raspberry Pi 3 series. It has a 64-bit quad-core processor running at 1.4GHz, 2.4GHz and 5GHz dual-band wireless LAN, Bluetooth 4.2 / BLE, Ethernet faster and more pass-through separate PoE function PoE HAT dual-band wireless LAN has modular compliance certification, allowing circuit boards to be designed into final products, significantly reducing wireless LAN compliance testing, thus increases cost and time to market. Raspberry Pi 3 Model B + maintains the same mechanical dimensions as Raspberry Pi 2 Model B and Raspberry Pi 3 Model B.
 Specifications:

Processor:  
Broadcom BCM2837B0, Cortex-A53 64-bit SoC @ 1.4GHz

Memory:   
1GB LPDDR2 SDRAM

Connectivity: 
1) 2.4GHz and 5GHz IEEE 802.11.b/g/n/ac wireless LAN, Bluetooth 4.2, BLE
2) Gigabit Ethernet over USB 2.0 (maximum throughput 300Mbps)
3) 4 √ó USB 2.0 ports

Access:
Extended 40-pin GPIO header

Video & sound:
1)  1 √ó full size HDMI
2)MIPI DSI display port
3) MIPI CSI camera port
4)4 pole stereo output and composite video port

Multimedia: 
H.264, MPEG-4 decode (1080p30); H.264 encode (1080p30); OpenGL ES 1.1, 2.0 graphics

SD card support:
Micro SD format for loading operating system and data storage

Input power:
1) 5V/2.5A DC via micro-USB connector
2) 5V DC via GPIO header
3)Power over Ethernet (PoE)‚Äìenabled (requires separate PoE HAT)

Environment: 
Operating temperature, 0‚Äì50¬∞C.







PIN OUT with GPIO:


 
Figure 3.1. Pinout Layout of Raspberry pi 3B+


	Microphone:

An amplifier may be a gadget that deciphers sound vibrations within the discuss into electronic signals or recorders them to a recording medium. Amplifiers empower numerous sorts of sound recording gadgets for purposes counting communications of numerous sorts, as well as music and discourse recording as shown in the fig 3.2 is a microphone.

 
Figure 3.2. Microphone

	
	
	FSR Pressure Sensor:

A Force sensitive resistor (FSR) as shown in figure 3.3 may be a fabric which changes its resistance when a drive or weight is connected. In other words, Force sensitive resistor it's a sensor that permit you to identify physical weight, pressing and weight.



 

Figure 3.3. FSR Pressure sensor

DHT11 Temperature and Humidity Sensor: 

The DHT11 temperature and humidity sensor as you can see in figure 3.4 offers a temperature and humidity sensor complex with a calibrated digital signal output. Adopting its own digital signal acquisition technology and temperature/humidity sensing technology ensures high reliability and excellent long-term stability This sensor includes a resistive humidity measuring element and an NTC temperature measuring element, and connects to a high-performance 8-bit microcontroller to provide superior quality, fast response, anti-interference ability and cost savings.

 
Figure 3.4. DHT11 Humidity Sensor



MATLAB Software: 

MATLAB is a high-performance language for technical computing. It integrates calculations, visualizations, and programming in an easy-to-use environment where problems and solutions are represented by familiar mathematical symbols. Typical uses include: Mathematics and calculations Algorithm development Modelling, simulation, and prototyping Data analysis, exploration, and visualization Engineering and scientific graphics Application development, including building graphical user interfaces MATLAB it is an interactive system. The basic data the element is an array that does not need to be dimensioned. This allows you to solve many technical calculus problems, especially those with array and vector formulas, in a fraction of the time required to write programs in non-interactive scalar languages like C or Fortran. MATLAB was originally written to provide easy access to the matrix software developed by the LINPACK and EISPACK projects, which together represent the latest level of matrix computing software. MATLAB has received input from many users after years of development. In a university setting, it is a standard teaching tool for introductory and advanced courses in math, engineering, and science. In industry, MATLAB is the tool of choice for efficient research, development, and analysis. MATLAB has a series of application-specific solutions called toolboxes. Very important to most MATLAB users, the toolbox allows you to learn and apply professional techniques. The toolbox is a complete collection of MATLAB functions (Mfiles) that can extend the MATLAB environment to solve specific types of problems. The areas where the toolbox can be used include signal processing, control systems, neural networks, fuzzy logic, waves, simulation, etc.


THINGSPEAK IOT Cloud Platform: 

ThingSpeak is an IoT analytics platform service that enables you to aggregate, visualize and analyze data streams in real time in the cloud. ThingSpeak provides an instant display of data posted to ThingSpeak by your device. With the ability to run MATLAB code in ThingSpeak, you can analyze and process data online as it comes in. ThingSpeak is generally used for prototyping and proof of concept of IoT systems that require analytics.  The Internet of Things (IoT) describes an emerging trend in which a large number of embedded devices (things) are connected to the Internet, and often provide sensor data to cloud storage and cloud computing resources, where the data is processed and analyzed to obtain important information. The inexpensive capabilities of cloud computing and increased device connectivity are driving this trend. IoT solutions are designed for many vertical applications such as environmental monitoring, health monitoring, fleet monitoring, industrial monitoring, and home automation. IoT system includes all these elements. ThingSpeak applies to the cloud part of the chart and provides a platform to quickly collect and analyze data from sensors connected to the Internet.























CHAPTER 4
SOULUTION\DESIGN\IMPLEMENTATION

This chapter is divided into three sections. The first section is ‚ÄúSolution‚Äù In this section, complete analysis of related works along with optimal solutions is discussed. The second section is ‚ÄúDesign‚Äù in which the comparison of different models of Raspberry Pi is done with Raspberry Pi 3Model B+ using tables and statistics via bar charts. This will show the quality of this project. Software design shows knowledge of database used and hardware setup shows circuit diagram discussed along with figure to show the virtual design or skeleton of the project. Third part is ‚ÄúImplementation‚Äù in which the methodology and working of the project is discussed.

SOLUTION:

Several studies have documented the effects of stress on various measurable physiological indicators of sleep and important mental functions for daily activities. polysomnography is a technology used to identify different sleep stages. It consists of EEG detection to form brain waves, EMG to detect eye movements, and EMG to record muscle tension.  Research based on polysomnography observed that the expectation of increased demand for (worry about upcoming/expected work) can change some of the physiological indicators of sleep, i.e. The slow-wave sleep cycle decreases by and the heart rate increases. Slow wave sleep is the deepest stage of non-rapid eye movement sleep, sleepwalking, sleep and memory consolidation occur. Total sleep time and sleep level Fragmentation (sleep interruption episodes) has been associated with poor performance on psychomotor tests, which recorded participants' ability to participate in responses to exercise, and assessment of mental capacities. learning, self-awareness and logical reasoning. Performing function, that is, the cognitive ability to perform a set of functions to achieve the desired goal, was found to be sensitive to shorter sleep time and sleep fragmentation. Many studies use a combination of polysomnography and measurements of hormones to assess the effect of stress on sleep. Taking as an example, in a study on post-traumatic stress disorder (PTSD), is an extreme manifestation of stress. Compared with control patients, 4,444 sleep arousals in PTSD patients 4,444 was significantly increased. Furthermore, these awakenings were positively correlated with levels of ACTH (adrenocorticotropic hormone) (a key participant in the HPA pressure pathway) and self-perceived depth of sleep. ACTH and cortisol levels in the first half of sleep were found to be negatively correlated with the amount of slow wave sleep in. Similarly, another study showed that 4,444 functional changes in the HPA axis can cause 4,444 sleep disturbances in PTSD. The ACTH level was significantly increased after taking a compound called Me pyrone, which prevents cortisol synthesis, predicting a decrease in delta power EEG activity in PTSD patients. Systolic blood pressure was found to be increased due to psychological stress, and this effect was amplified by sleep deprivation. Parameters such as respiratory rate and heart rate also tend to change when a person sleep. Snoring level is an important parameter that helps infer pressure levels; is measured in decibels because it is the sound produced when breath rate increases abnormally per minute. Snoring below 50 dB is considered normal, but when the snoring level is higher than 50 dB, there is a high probability of stress and other health problems. Similarly, if the breathing rate or the number of breaths per minute is between and 1517 breaths per minute (bpm), it is considered healthy, and a breathing rate greater than indicates stress. In the same way, the heart rate of is 510 times slower than usual.


DESIGN:

This section is divided into four subsections. The first subsection is ‚ÄúSystem Requirements‚Äù. In this subsection, description, table and statistics are mentioned which proves the good quality of Raspberry Pi 3 model B+ (used in this project) as compared to other models. The second subsection is ‚ÄúMethodology‚Äù in which the method used in this project is explained in details with figures. The third subsection is ‚ÄúSoftware Design‚Äù in which the discussion about software used in this project is done and fourth section is ‚ÄúHardware Design‚Äù which contains the circuit diagram to show the virtual map of hardware setup.

System Requirements:

	Raspberry pi 3B+ 
	Pressure sensor (based on resistor)
	Temperature sensor (accuracy upto ¬±2%) 
	Humidity sensor (accuracy upto ¬±2%) 
	Vibration Motor Microphones 
	MATLAB (for ML and breath detection)
	Python IDE (for runtime analysis) 
	ThingSpeak platform (for IOT) 
	Graphana (for IOT) 
	G Drive (for IOT) 
	Blender (for 3d modeling)

Methodology:

The implementation and design of our project is that it will recognize different sleep disorders and sleep patterns through use of a smart pillow with Machine learning and smartwatch. We are aiming for a better accurate and non-intrusive way of detecting different sleep disorder and bad sleep patterns. Our aim is the ease of use for both in hospital and commercial platform. Our project will be using both physical signal from the pillow sensors and biological signals from the smartwatch and by comparing both data and displaying it on the screen of users and sharing it can also be directly connected with your doctor, this project accuracy and functionality will be first of its kind.


        Software Design:
MATLAB:
To accurately get and detect breathing and snoring with machine learning we used MATLAB We used Logistic Regression on MATLAB which is basically a map classification algorithm.the problem of, the variable (or output) y can only take discrete values for a given function (or input) set X and take that forward. The algorithm builds a regression model and for the specified data the items belong to the category numbered "1". Logistic regression uses a sigmoid function to model the data. 
ùëî (ùëß) = 1 1 + ùëí-ùëß (5)

 This function maps a real value to a value between 0 and 1. Machine learning uses sigmoid to map to predicted probabilities. The cost function represents the purpose of the optimization. By writing and minimizing cost functions, you can minimize errors and develop accurate models. 

ùêΩ (Œ∏) = - 1 ùëö Œ£ [ùë¶ (ùëñ) ùëôùëúùëî (‚ÑéŒ∏ (ùë• (ùëñ) )) + (1 -ùë¶ (ùë• (ùëñ) )

sigmoid functions. We are using gradient descent to reduce the cost function. Minimize the cost function by running the dip function on each parameter. 

Œ∏ùëó = Œ∏ùëó-Œ±Œ£ùëö ùëñ = 1 (‚ÑéŒ∏ (ùë• (ùëñ) ) -ùë¶ (ùëñ) (ùëñ) (ùëñ) ) ùë•

Our model provided an accuracy of 73% of our pulse shape. If the samples you are trying to classify are highly correlated, or is highly nonlinear, then the logistic regression coefficients do not predict the gain/loss well in each feature. 
SVM (Support Vector Machine) "Support Vector Machine" (SVM) is a machine learning algorithm for teachers. This algorithm plots each data item as a point in an n-dimensional space (n is how many features you have) and each feature value is a specific coordinate value. Then it performs classification by discovering a hyperplane that distinguishes the two classes well. The reasons for choosing to use SVM are many. Because the SVM uses a fraction of the training points (also called the support vectors) in the decision function, the is also more memory efficient. It is also versatile and can be specified as a decision function and built using various kernel features. When designing a SVM, we built the SVM using several common kernels with optimized hyperparameters. Kernel C Value Gamma Accuracy RBF 10 0.01 88% Linear 1 0.001 83% Sigmoid 0.1 1 43% Poly 100 0.001 73% .1 SVM44 Accuracy Table Results 

Forest (RF), as the name implies, consists of a number of separate decision trees that operate in an ensemble. It outputs individual tree class predictions for random forests, and the class with the most votes is the model prediction. Prediction tree sample. The basic concept behind Random Forest is simple yet powerful. The data science peak is why the random forest model works so well is that many relatively uncorrelated models (trees) acting as committees outperform any of the individually constructed models. It is important to have low correlations between models. The uncorrelated model can produce ensemble predictions that are more accurate than any of the individual predictions. 

The reason for this surprising effect is to protect the trees from each of the 22 individual errors (unless they are always all causing errors in the same orientation). Some trees may be wrong, but many others are correct, so with group the tree can move in the right direction. The Random Forest is a meta-estimator that combines multiple decision tree classifiers to for various subsamples of a data set, using averages to improve prediction accuracy and control over totals. The subsample size is always the same as the original input sample size, but the sample is drawn instead when bootstrapped. To design an individual estimator, you need parameters, such as: Estimators: Number of trees in the forest (n = 100)  max_depth: Maximum depth of the tree (the node was expanded when all leaves contained less than min_samples_split samples.)  min_samples_split: Minimum number of samples required to split internal nodes (minimum = 2) bootstrap: Whether to use several samples multiple times in a single tree (to use several samples) To evaluate the performance of a machine learning model multiple times in a single tree, it needs to be tested with some invisible data.As can be seen in figure 4.1 and 4.2 General. Cross-validation (CV) is one of the techniques used to validate machine learning models, though there are resampling steps used to evaluate models when data is limited. In order to run CV, you have to set aside data samples/portions that are not used to train the model. later use this sample for testing/validation. A common method used for crossover test is the Fold crossover test.
The Fold method can yield a model with less bias compared to compared to other methods. This is to ensure that all observations from the original data set can be represented in the training and test sets. Start by randomly splitting the entire data into Folds. Then use the K-1 (K minus 1) fold to fit the model.
 
Figure 4.1. MATLAB Breathing Simulation





 Figure 4.2. MATLAB Snoring Simulation
ThingSpeak:

To visualize our data, we have used ThingSpeak which is an IoT analytics platform service that enables you to aggregate, visualize and analyze data streams in real time in the cloud as shown in figure 4.3. ThingSpeak provides an instant display of data posted to ThingSpeak by your device. With the ability to run MATLAB code in ThingSpeak, you can analyze and process data online as it comes in. ThingSpeak is generally used for prototyping and proof of concept of IoT systems that require analytics.  The Internet of Things (IoT) describes an emerging trend in which a large number of embedded devices (things) are connected to the Internet, and often provide sensor data to cloud storage and cloud computing resources, where the data is processed and analyzed to obtain important information. The inexpensive capabilities of cloud computing and increased device connectivity are driving this trend. IoT solutions are designed for many vertical applications such as environmental monitoring, health monitoring, fleet monitoring, industrial monitoring, and home automation. IoT system includes all these elements. ThingSpeak applies to the cloud part of the chart and provides a platform to quickly collect and analyze data from sensors connected to the Internet.

 
Figure 4.3. ThingSpeak Simulation
Computer Languages:
The computer languages used in this project are Python and C#. Further discussion below shows the design about this language.

Python:

The discussion about Python language is the summary of Python is a high-level functional language for both studying and programming in a specific environment. This is so built that it is descriptive, its syntax is simple to use and one can write Python programs on a far lower level than C and C++, despite the vast number of standard libraries in its storage and automated memory management framework. The concept can be condensed, shortened, readable and easy to work. The fourth industrial revolution has now achieved the miracles of its world that include autonomous systems, quick data transfer through digital systems, quick storage and data recovery and quickly predict the importance of a feature to use that data. These are done through the data sciences and Python language libraries are used to work quickly. From above discussion, it is evident that Python language is simple, fast working and less time consuming. So, it is preferred in this project to prevent the software design from complexity and let it work fast and efficiently.

NumPy:
NumPy is a module of Python, which supports large multidimensional arrays and matrices together with a wide math method. Initially the founder Jim Hugunin designed NumPy's ancestor, Numeric. In 2005, Travis Olphant developed NumPy by integrating Numarray computing capabilities in numerical with extension changes. NumPy has several developers and is free source program.

SciPy:
SciPy includes numerous optimization components including a linear algebra, multiplication, interpolation, special functions, FFT, image and signal processing, ODE solvers, and other computing related tasks. The NumPy stack contains applications like Matplotlib, pandas & sympy, etc., and a wide variety of libraries for science- programming. The key part of the array item is SciPys. SciPies. The stack incorporates the same technology as the other modules in MATLAB, Octave and Skylab. The stack NumPy is also often referred to as the SciPy row. Officially approved under the BSD license, the SciPy library is sponsored and assisted by open software organizations. This is funded by Nymphicus, the collective foundation for replicable and transparent inquiry.



Hardware Design:
This section has two parts. The first part is ‚ÄúCircuit Picture‚Äù which shows the map of hardware connection used in the project symbolically in under shown figure. The second part is ‚ÄúDescription‚Äù in which a brief elaboration of circuit diagram is done.

Circuit Description:
To a great success we will have used a Raspberry 3b+ or another peripheral to incorporate the different sensors and combing the different readings using our own precise coding and best-known tools for detecting physical body signals, for the best accurate and precise measurement and using a ThingSpeak and google drive with MATLAB for better and precise accuracy. Both the smart pillow and smartwatch will be connected through an app which will display the different reading from each of them. For the bio signal detection, we will use an android smartwatch and a self-made app for data extraction from the smartwatch. If the system detects variation in bio signal it will directly give alert and the data will be compared with the physical readings from the smart pillow. For combining both result and accurately judging and detecting sleep disorders and sleep patterns compare both results in real time and will be send to the hospital or his doctors and added to the patient records. A spate of components arrangement prototype is shown in figure 4.4.

 
Figure 4.4. Circuit



IMPLEMENTATION:
In this section, implementation of this project is discussed in two parts, the ‚Äúsoftware implementation‚Äù and ‚Äúhardware implementation‚Äù.

Software Implementation: 
In this part, the database and languages used to implement the project is discussed.

MATLAB:

Peak of the signal: 
The highest point of the wave is called the peak. It is described in Figure 4.1. Figure 4.2
Hilbert Transformation: 

Transformation Hilbert is very useful when calculating the current attributes of a series of special amplitudes and frequency. A detailed discussion of Hilbert transformation is outside the scope of this work 

The shell of the signal: 
A signal envelope is a clear signal to see by tracking the maximum consecutive values and specifying it. Figure 4.1 and Figure 4.2 shows the envelope. Analysis, an envelope, E (t) of the signal, X (T), is defined because the size of the analysis signal is shown in the following equation: 

E (t) = P x (t) 2 + x (T) 2 

In which X(t) indicates the Hilbert transformation of x(t). 

Down sampling: 
Sampling is the process of reducing the scanning speed of the signal. This happens to reduce the data speed or the data of size. This process is useful if we cope with fewer samples for the analysis. Despite the risk of data loss in our project, this risk is not a major threat to for the analysis.
 
Accuracy:
 Accuracy: Accuracy is the ratio of the number of relevant records to be taken for the total number of non-contiguous and relevant records. Figure 4.2: Signal change It is usually displayed by percent. In terms of mathematics, accuracy is displayed as follows: 

Precision=((No.of relevant records retrieved)/(Total no.of irrelevant and relevant records retrieved))


Recall: 
Restore is the ratio of the number of related data records with the total number of related data records. It is also shown in percent form. With regard to mathematics, the call-back is shown as follows: 

Recall =((No.of relevant records retrieved)/(Total no.of relevant records ))


FMeasure: 
FMeasure is a measure of the effectiveness of information users. It is the harmony of the accuracy of and withdrawal. In terms of mathematics, the FMeasure is shown as follows:

F-measure =2*((Precision * Recall)/(Precision + Recall))

techniques for recognizing and stools of the breath used in this thesis can be In the following three steps:
	Reduce data relating to respiratory samples into a comfortable shape. 
	Extract the envelope of the respiratory patterns.
	The data analysis decreases to extract relevant information. Relevant Information in this project is ‚Ä¢ Sorting the breath based on amplitudes  
Extracting information that breathing on the breath, every minute, d. H. BPM. is the first step, we reduce data available for analysis in a practical form. Then we carry out the data analysis in the next two steps. In the lower part of we discuss each of these sections. 

Envelope Extraction 
A recorded breath sample contains large data. Sometimes this is extracting the necessary information with these huge data no easy task. Therefore, it is really to bring this data into a comfortable shape before we carry out additionally. In addition, these huge data set the actual restrictions at as a memory, processing time, V.V. In Figure 4.2 we observed a breath from 4.2: The shell of a normal respiratory signal model of a topic can be closely connected to sinusoidal waveforms. In addition, the peaks of the extraction sleeve relate to the inhalation of or the respiratory air. This idea actually played an important role in the detection of breath. In this project, we reduce data available for handling with algorithms called Envelope Extraction. Now we will briefly explain the technical extraction envelope. A standard envelope extraction algorithm consists of three steps. In the first step, the signal is quadratic, further it is transmitted by low pine filters, and in the last step we use the square root of the signal achieved by the previous step. In this project, we select the LowPass Butterworth filter of 3 order 3, 444 of which are cutting frequencies of the filter about half of the sampling frequency of the respiratory signal. We have come to this value after the test.




ThingSpeak:

Our project is based on visualization of data for which we have used ThingSpeak and to visualize our data, we have used ThingSpeak it is an IoT analytics platform service that enables you to aggregate, visualize and analyze data streams in real time in the cloud. ThingSpeak provides an instant display of data posted to ThingSpeak by your device. With the ability to run MATLAB code in ThingSpeak, you can analyze and process data online as it comes in. ThingSpeak is generally used for prototyping and proof of concept of IoT systems that require analytics. First you have to make an account in ThingSpeak and sign in which will take you to home screen as shown below in figure you have to make a channel and name it we have already done it and named it Room temp and humidity as shown in figure 4.5.

 ![image](https://user-images.githubusercontent.com/59439727/181619454-54e76f75-da82-473f-ac81-6814b1c0491a.png)

Figure 4.5. ThingSpeak

Now after making an account and signing in and making a channel you have to take the API key for uploading the data to ThingSpeak specifically to you channel as shown in figure 4.6.


![image](https://user-images.githubusercontent.com/59439727/181619564-052796ba-334e-493b-8f47-7a8dbcce20e7.png)
 
Figure 4.6. ThingSpeak


After adding API key to your code, you have to specify which field to upload the Data to so select the fields by doing to Channel Setting and selecting field as shown in the figure 4.7.

![image](https://user-images.githubusercontent.com/59439727/181619611-93b508e4-ae37-47a2-9c80-99e262c34cfc.png)

 
Figure 4.7. ThingSpeak

After diong all of the above steps your data will be shown in the form of graph and updated intervaly as shown in figure 4.8.

 ![image](https://user-images.githubusercontent.com/59439727/181619666-8c6279f5-53e5-4f9e-b10b-597231c2fc3b.png)

Figure 4.8. ThingSpeak
Now for sending and saving the voice signals to MATLAB we used google Drive OAuth 2.0 Playground in which we first select the Drive API v3 as shown in figure 4.9. After that we authorize the API for use of sending and collecting data as shown in figure 4.10.

 ![image](https://user-images.githubusercontent.com/59439727/181619786-2bed9848-f6aa-4ca7-a6b7-662bfaffb78e.png)

Figure 4.9.  Google OAuth 2.0 
 
 ![image](https://user-images.githubusercontent.com/59439727/181619809-38dfd96f-2261-4cc0-a7f3-16124e4245f4.png)

Figure 4.10.  Google OAuth 2.0 

![image](https://user-images.githubusercontent.com/59439727/181619883-9a2c3ac3-345a-478a-a691-e0f88623e357.png)
 
Figure 4.11.  Google OAuth 2.0 

![image](https://user-images.githubusercontent.com/59439727/181619913-6618d66f-6c16-4671-a608-a7e23989ee0b.png)
 
Figure 4.12.  Google OAuth 2.0 
![image](https://user-images.githubusercontent.com/59439727/181619933-11142ca2-263d-41f5-a9a5-cec2faf657c5.png)
 
Figure 4.13.  Google OAuth 2.0 

After doing the steps shown in the above figure as you can get the token and can use it to send and collect data from google Drive

Hardware Implementation:

In ‚ÄúChapter 3‚Äù description or properties or general working of hardware components used in this project are discussed. Here the implementation of those hardware components is discussed. In other words, the discussion is based on how those hardware components are working or contributing in this project. So, the discussion is covered under the following headings.


Raspberry pi 3B+:

The raspberry pi is mostly used for runtime analysis and sending data to ThingSpeak and google drive with also taking data from sensors. The Raspberry pi which is acting like the brain for our project with much emphasis on the working and communication. Raspberry pi is also used as a hub between the pillow and the computer in which it sends the data from the pillow. It collected from the pillow to think speak or the PC in for evaluation through MATLAB analysis and detecting briefing and. Ignoring up to an accuracy.

Pressure sensor:

The pressure sensor. If used. For monthly fencing, the person had when it is placed on the pillow. It is like making the pillow autumn. It is mostly used for making the pillow automatic. The pressure sensor which had been mover is an FSR sensor. It works with the resistance and mergers of pressure or and displaced in the middle and the of the pillow. When someone placed their head the pressure sensor detects it are which in which inputs. Into the Raspberry Pi and is used as an automatic on and off switch. The pressure sensor is also used for monitoring the head position and the movement of the head and also the posture of the head. It is. It is also used for detecting any EU, any improper movements by the head and also D it. Can be used through the pressure sensor. It can be evaluated that type of person has woken up or raved head from the pillow, who during a certain time or duration.

Temperature Humidity sensor: 

The temperature and humidity sensor, which are your detected by the sensor DHT, one is mostly used for detecting the temperature of the body or the head on the pillow. It's humidity and temperature and also another sensor is used. For detection of temperature and humidity from the surrounding, which is then compared, if the person which is lying on the pillow has a high fever or sweating. 




Microphones:

The microphone is mostly used for recording the input signal. Input, breathing or snoring. It can also be used for any noise cancellation or any 2D modeling of array of the briefing two channel modeling of Reaping. There are two microphones placed from the left and right side. If the head position is on the right and left or on the center in which both the microphone can pick up the briefing off at the person on the pillow.

























CHAPTER 5
RESULTS/CONCLUSION/ RECOMMENDATION

In this chapter, we will be discussing the working of our prototype which will comprise of Ideas, algorithms and principles. For the convenience and ease of understanding, we have divided this chapter into following sub-categories:

RESULTS:

ThingSpeak Analysis:
In the first step we take all the values in real time from the sensors and send it to ThingSpeak for observation in real time all the data is uploaded into things speak and can be reviewed from anywhere as it is a cloud Platform. It can also be configured with the MATLAB for uploading any MATLAB analysis through directly from the MATLAB to ThingSpeak so it is the best scenario for us to choose ThingSpeak as our cloud platform. It is also open source. The data which is sent to the things speak in send through the Internet and Internet which should be always available for the data to be monitored at all time. The data graph is divided into different fields in which each field has a specific value which is uploaded to it by the sensor. As we are using about 5 field in which the first field figure 5.1 shows the value of room temperature and the second field shows which is figure 5.2 shows of room humidity and Figure 5.3 which is the third field shows the value of Human temperature. And Figure 5.4 which is field four, which shows the value of human humidity, which described so if the human has a fever from which he is sweating. The last field which is figure 5.5 shows snoring of the person on the pillow and it can be monitored remotely through ThingSpeak. All these values are updated in an interval of couple of seconds and can be reviewed in real time.


 
MATLAB Analysis:
There were various breathing intervals used in the first analysis. That is a record of 7 minutes of normal breathing. Normal breaths are recorded 7 min using a microphone as shown in figure 5.7. This recording used breaths per minute for analysis. Values obtained from MATLAB and real history. Using the formulas described in the subsection above, the fit rate is 95%, the recovery rate is 100%, and the FMeasure is 0.892. Actual values here represent envelope extractions and classifications from follicular respiration listened to recorded signals and subjected to manually calculated respiratory rates per minute. Recording of Normal Breathing Over Nearly Hours Normal breathing is recorded for almost 1 hour using a microphone. This recording uses breaths per minute for analysis. The number of breaths obtained from the actual record is 3988. The respiratory rate obtained using the MATLAB program is 3721 with snoring as shown figure 5.11 and 5.12. The lost breath was due to the low intensity of the recorded breath. Recording of normal breathing in a disturbed environment Normal breathing is recorded 7 min using a microphone in a disturbed environment. Envelope extraction and classification of Wheezes breaths for this recording use breaths per minute for analysis. The number of breaths obtained from the actual record is 365. The respiratory rate obtained using the MATLAB program is 304 as shown in figure 5.7 and 5.8. Breathing lost due to external noise in the recorded breath. 

The result is derived from a sample of the data stored in the file. In short, this method works for offline recorded breathing samples. Real-time processing of data is not possible. Noise and high amplitude glitches are still a challenge for the technology we have adopted. Background noise is avoided in certain situations as shown in figure 5.10. Therefore, it is difficult to completely remove background noise. We believe that a more stringent signal processing method is needed to solve this problem. Peak values indicate Dorsum and divergent instances. However, in any case, the peak detection algorithm is not powerful enough. This is also one of the problems caused by background noise and sudden defects. For good quality recordings, this technology works well. This was demonstrated in experiments performed as part of validation. This method has not been satisfactorily performed in long recordings, in this case an hour. This will let you know that the recording quality has deteriorated. Our observations have shown that it is difficult to detect such respirations when the amplitude of the respirations is very low as shown in figure 5.13. Therefore, some respirations have not been detected. Classification depends on the maximum value that occurs in the recording, so high-amplitude glitches can lead to erroneous results.
 
CONCLUSION:

 This project has helped us gain better perspective on various aspects that is related to our course of study as well as the practical knowledge of the data science, machine learning and mechanism of Internet of things (IoT). 

Apart from this, also we became familiar with the software analysis, implementation, and testing, designing, maintenance related to our project. Breath detection and analysis helps detect various abnormalities in breathing patterns. The various techniques of breath detection and analysis are mainly classified into contact methods and non-contact methods. As described in the paper, one of the major drawbacks of using the contact technology is that the subject must wear the sensor, which can be uncomfortable for the subject. It also increases maintenance and installation costs. In this paper, some of the breathing analysis and detection techniques recently developed in have been described. 

The theory of sleep stages mentioned in the paper is based on the respiratory rate and the subject's body temperature which are vital during sleep and the humidity for reanalysis. It is recommended to classify sleep stages using the experimental setup with the algorithm immediate application. The effectiveness of the proposed experimental setup and respiration detection and analysis algorithms is limited by the noise intensity level of the surrounding environment. The recording time of current breaths is limited to 1 hours. The longer the duration, the longer it takes to detect and analyze respiration, except for computing memory issues. This is still some issue outside the scope of the work presented and the future direction can be considered.

The analysis of data to the cloud platform of IOT is a great platform for any real time analysis of data and to collect data remotely with no additional aspects of burden and low drain on the processor. This IOT platform has greatly and vastly opened doors to new logic scenarios and easy access.

RECOMMENDATION:

From now on, the pickup sensor of the sound wave signal reflected by breathing of the person they can transmit the sound wave with the microphone, and the speaker can use the microphone to use the breath-sensing sound wave and detect the breathing through it with avoiding any external noise which had a greatly impact on the output precision and accuracy. With the addition of WebRTC, was able to securely transfer audio and video in real time which will be of great security installment and addition to protection of privacy and stability. This pillow can be changed to a pressure pad to generate a pressure pattern to massage the head and relax the user. An additional row heater with safety circuit protection and a cooling system can be injected into the pillow to control the temperature of the and improve mood.

















REFRENCES

	Vandana, S., Tharun Palla, Soumya Pallempati, and VineethaPadavala. "Smart pillow.

	Li, ÊùæÁîü Christopher Jiu. ‚ÄúSmart Pillow in Health Detection System Based on Temperature and Humidity Sensors‚Äù Sensor 18, no. 11 (2018): 3664.

	Fedorin, Illia, Kostyantyn Slyusarenko and Margaryta Nastenko. ‚ÄúRespiratory Event Screening Using Consumer Smartwatches‚Äù Minutes of the 2020 ACM International Joint Conference on Pervasive and Ubiquitous Computing and Minutes of the 2020 ACM International Symposium on Pervasive Computing and Wearable Computers, pp. 2528. 2020. 

	Arulvallal, Santhoshini, U.Snekhalatha, and T. Rajar Lakshmi. "Design of Wearable Devices and Development of for Continuous Monitoring of Sleep APNEA Disorders" 2019 International Conference on Communication and Processing of Signal (ICCSP), pp. 00500053. IEEE, 2019.

	Fedorin, Illia, Kostyantyn Slyusarenko, and Margaryta Nastenko. "Respiratory events screening using consumer smartwatches." In Adjunct Proceedings of the 2020 ACM International Joint Conference on Pervasive and Ubiquitous Computing and Proceedings of the 2020 ACM International Symposium on Wearable Computers, pp. 25-28. 2020.

	Arulvallal, Santhoshini, U. Snekhalatha, and T. Rajalakshmi. "Design and Development of Wearable Device for Continuous Monitoring of Sleep APNEA Disorder." In 2019 International Conference on Communication and Signal Processing (ICCSP), pp. 0050-0053. IEEE, 2019.



  APPENDIX

There are two headings ‚ÄúAppendix A‚Äù and ‚ÄúAppendix B‚Äù under extra knowledge about some terms used in the report are given to increase the knowledge of the reader.

Discussion of Important Terms


Butter worth filter:

The frequency response of a Butterworth filter is flat-maximum (i.e. ripple-free) in the passband, and rolls off towards zero in the stopband. [2] When plotted as a logarithmic Bode diagram, the response slopes straight toward negative infinity. The response of the 1st order filter rolls off by -6 dB per octave (-20 dB over 10 years) (all 1st order low-pass filters have the same normalized frequency response). The 2nd order filter reduces to -12 dB per octave and the 3rd order filter reduces to -18 dB per octave. Butterworth filters have an amplitude function that varies monotonically in œâ, unlike other filter types that have non-simple ripples in the passband and/or stopband. Compared to the Chebyshev Type I/Type II filter or elliptic filter, the Butterworth filter has a slower roll-off, so higher orders are required to achieve certain stopband specifications, but the Butterworth filter has a more linear phase response in the passband. Then Chebyshev Type I/Type II and Elliptic Filters can achieve.

Although these ideal filters cannot be achieved, Butterworth has shown that as the number of filter elements with appropriate values increases, continuous closer approximations can be obtained. At that time, the filter produced a large ripple in the passband, and the selection of component values was very interactive. Butterworth has a low cutoff frequency normalized to 1 radian per second and a frequency response (gain).




Gaussian Noise:

In a continuous physical process, a probability distribution that explains random variation. Named after the German physicist Carl Friedrich Gauss in the 18th century. The distribution is probabilistic, such as the so-called Brownian motion, discovered by British botanist Robert Brown, who first studied the random voltage changes in carbon resistance due to thermal motion or the fast, apparently random motion of fine particles in 1827 gas. Describes the process. As seen under the microscope. The distribution formula is based on exp (x2), which means that on average it is less likely to have large variations. Also known as a mezzanine able or normal distribution. As with the thermal motion above, if the electrical fluctuations follow a Gaussian distribution, it is called Gaussian noise or RANDOM NOISE. Another example occurs with some types of radio lamps or semiconductors where the noise can be amplified to create a noise generator. Note that in all these cases, only the random amplitude of the signal is classified as Gaussian noise. That spectrum is not necessarily similar to the white noise spectrum.

FFT (Fast Fourier Transform):

The Fast Fourier Transform (FFT) is an algorithm that computes the Discrete Fourier Transform (DFT) or vice versa (IDFT) of a sequence. Fourier analysis transforms a signal from the original domain (often time or space) into a frequency domain representation and vice versa. DFT decomposes a series of values into components with different frequencies and obtains them. This task is useful in many areas, but calculating directly from the definition can be too slow and impractical. The FFT takes the DFT matrix into account for the product of rare (almost 0) factors and performs fast compute of these transforms. As a result, this happens simply by applying the DFT definition to. Where N is the size of the data. The speed difference can be huge, especially for long datasets where N can be in the thousands or millions. In the presence of rounding errors, many FFT algorithms are much more accurate than evaluating the DFT definition directly or indirectly. There are various FFT algorithms based on various published theories, from simple complex arithmetic to group theory and number theory.
